<!DOCTYPE html>
<html>
<head>
<title>Jewels of Babylon: Routine at 64060</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63972.html">63972</a>
</td>
<td class="up">Up: <a href="../maps/all.html#64060">Map</a></td>
<td class="next">
Next: <a href="64168.html">64168</a>
</td>
</tr>
</table>
<div class="description">64060: Action: Close/ Shut</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut</td>
<td class="address-2"><span id="64060"></span>64060</td>
<td class="instruction">CALL <a href="50299.html">Handler_DirectObject</a></td>
<td class="comment-1" rowspan="1">Call <a href="50299.html">Handler_DirectObject</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64063"></span>64063</td>
<td class="instruction">RET C</td>
<td class="comment-1" rowspan="1">Return if <span class="register">D</span> is less than 6.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64064"></span>64064</td>
<td class="instruction">LD HL,60094</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59850.html#60094">PhraseTokens_Door</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64067"></span>64067</td>
<td class="instruction">CALL <a href="50047.html">MatchPhraseTokens</a></td>
<td class="comment-1" rowspan="1">Call <a href="50047.html">MatchPhraseTokens</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64070"></span>64070</td>
<td class="instruction">JR NZ,<a href="64060.html#64133">Action_CloseShut_3</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="64060.html#64133">Action_CloseShut_3</a> if <span class="register">D</span> is not equal to 6.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64072"></span>64072</td>
<td class="instruction">LD A,(48331)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="48331.html">CurrentRoom</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64075"></span>64075</td>
<td class="instruction">CP 97</td>
<td class="comment-1" rowspan="2">Jump to <a href="64060.html#64083">Action_CloseShut_0</a> if <span class="register">A</span> is room 97: "

<a href="53491.html">The Dusty Corridor</a>".</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64077"></span>64077</td>
<td class="instruction">JR Z,<a href="64060.html#64083">Action_CloseShut_0</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64079"></span>64079</td>
<td class="instruction">CP 98</td>
<td class="comment-1" rowspan="2">Jump to <a href="64060.html#64133">Action_CloseShut_3</a> if <span class="register">A</span> is not room 98: "

<a href="53511.html">The Pirate Treasure Chamber</a>".</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64081"></span>64081</td>
<td class="instruction">JR NZ,<a href="64060.html#64133">Action_CloseShut_3</a></td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut_0</td>
<td class="address-2"><span id="64083"></span>64083</td>
<td class="instruction">LD HL,59594</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59502.html#59594">Data_ItemGroup_Door</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64086"></span>64086</td>
<td class="instruction">CALL <a href="50177.html">CheckActiveScenicEvents</a></td>
<td class="comment-1" rowspan="1">Call <a href="50177.html">CheckActiveScenicEvents</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64089"></span>64089</td>
<td class="instruction">CP 46</td>
<td class="comment-1" rowspan="2">Jump to <a href="64060.html#64099">Action_CloseShut_1</a> if <span class="register">A</span> is not equal to 46.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64091"></span>64091</td>
<td class="instruction">JR NZ,<a href="64060.html#64099">Action_CloseShut_1</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64093"></span>
<div class="comments">
<div class="paragraph">
Print "The door is locked.".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64093"></span>64093</td>
<td class="instruction">LD HL,58097</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="58097.html">58097</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64096"></span>64096</td>
<td class="instruction">JP <a href="61498.html">PrintStringAndNewline_Alias</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="61498.html">PrintStringAndNewline_Alias</a>.</td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut_1</td>
<td class="address-2"><span id="64099"></span>64099</td>
<td class="instruction">CP 45</td>
<td class="comment-1" rowspan="2">Jump to <a href="64060.html#64108">Action_CloseShut_2</a> if <span class="register">A</span> is equal to 45.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64101"></span>64101</td>
<td class="instruction">JR Z,<a href="64060.html#64108">Action_CloseShut_2</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64103"></span>64103</td>
<td class="instruction">CP 48</td>
<td class="comment-1" rowspan="2">Jump to <a href="61576.html">Response_ItsAlreadyOpen</a> if <span class="register">A</span> is not equal to 48.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64105"></span>64105</td>
<td class="instruction">JP NZ,<a href="61576.html">Response_ItsAlreadyOpen</a></td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut_2</td>
<td class="address-2"><span id="64108"></span>64108</td>
<td class="instruction">LD BC,11564</td>
<td class="comment-1" rowspan="2">Call <a href="50214.html">TransformItem</a> to transform item 44 ("An open door") into item 45 ("A closed door").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64111"></span>64111</td>
<td class="instruction">CALL <a href="50214.html">TransformItem</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64114"></span>64114</td>
<td class="instruction">LD BC,12335</td>
<td class="comment-1" rowspan="2">Call <a href="50214.html">TransformItem</a> to transform item 47 ("An open door") into item 48 ("A closed door").</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64117"></span>64117</td>
<td class="instruction">CALL <a href="50214.html">TransformItem</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64120"></span>64120</td>
<td class="instruction">LD A,98</td>
<td class="comment-1" rowspan="2">Write 98 to *<a href="60176.html#60759">60759</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64122"></span>64122</td>
<td class="instruction">LD (60759),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64125"></span>64125</td>
<td class="instruction">LD A,97</td>
<td class="comment-1" rowspan="2">Write 97 to *<a href="60176.html#60764">60764</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64127"></span>64127</td>
<td class="instruction">LD (60764),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64130"></span>64130</td>
<td class="instruction">JP <a href="61546.html">Response_OK_Duplicate</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="61546.html">Response_OK_Duplicate</a>.</td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut_3</td>
<td class="address-2"><span id="64133"></span>64133</td>
<td class="instruction">LD HL,60096</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59850.html#60096">PhraseTokens_RockDoor</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64136"></span>64136</td>
<td class="instruction">CALL <a href="50047.html">MatchPhraseTokens</a></td>
<td class="comment-1" rowspan="1">Call <a href="50047.html">MatchPhraseTokens</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64139"></span>64139</td>
<td class="instruction">JR NZ,<a href="64060.html#64165">Action_CloseShut_4</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="64060.html#64165">Action_CloseShut_4</a> if <span class="register">A</span> is not equal to 97.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64141"></span>64141</td>
<td class="instruction">LD A,(48331)</td>
<td class="comment-1" rowspan="3">Jump to <a href="64060.html#64165">Action_CloseShut_4</a> if *<a href="48331.html">CurrentRoom</a> is not room 106: "

<a href="53649.html">The Mighty Rock Door</a>".</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64144"></span>64144</td>
<td class="instruction">CP 106</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64146"></span>64146</td>
<td class="instruction">JR NZ,<a href="64060.html#64165">Action_CloseShut_4</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64148"></span>64148</td>
<td class="instruction">LD A,49</td>
<td class="comment-1" rowspan="2">Call <a href="50015.html">Handler_Objects</a> with "The door is open".</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64150"></span>64150</td>
<td class="instruction">CALL <a href="50015.html">Handler_Objects</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64153"></span>64153</td>
<td class="instruction">JP Z,<a href="61576.html">Response_ItsAlreadyOpen</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="61576.html">Response_ItsAlreadyOpen</a> if "The door is open" is present in the current room.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64156"></span>64156</td>
<td class="instruction">CALL <a href="61551.html">Response_YouCant_Duplicate</a></td>
<td class="comment-1" rowspan="1">Call <a href="61551.html">Response_YouCant_Duplicate</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64159"></span>
<div class="comments">
<div class="paragraph">
Print "It's much too heavy.".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64159"></span>64159</td>
<td class="instruction">LD HL,58117</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="58117.html">58117</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64162"></span>64162</td>
<td class="instruction">JP <a href="61498.html">PrintStringAndNewline_Alias</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="61498.html">PrintStringAndNewline_Alias</a>.</td>
</tr>
<tr>
<td class="asm-label">Action_CloseShut_4</td>
<td class="address-2"><span id="64165"></span>64165</td>
<td class="instruction">JP <a href="61551.html">Response_YouCant_Duplicate</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="61551.html">Response_YouCant_Duplicate</a>.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63972.html">63972</a>
</td>
<td class="up">Up: <a href="../maps/all.html#64060">Map</a></td>
<td class="next">
Next: <a href="64168.html">64168</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1985 Interceptor Software UK &copy; 2025 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.6.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/jewelsofbabylon/">Source code</a>.</div>
<div><a href="../../asm/FA3C.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>